{% extends 'base.html' %}
{% load static %}

{% block title %}GovernPrep{% endblock %}

{% block content %}



<style>
    /* Page ka halka background color */
    body { background-color: #fdfdfd; }

    /* Animations */
    @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .fade-in-up {
        opacity: 0;
    }
    .fade-in-up.is-visible {
        animation: fadeInUp 0.8s ease-out forwards;
    }

    /* Hero Section */
    .hero-section { background: linear-gradient(45deg, #1d2671, #c33764); color: white; padding: 6rem 0; }
    .search-container { position: relative; }
    .search-container .form-control { height: 55px; padding-left: 3rem; }
    .search-container .search-icon { position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); color: #6c757d; }
    .hero-section .btn { height: 55px; font-weight: 600; }

    /* Stats Bar */
    .stats-bar { background-color: #f8f9fa; padding: 2.5rem 0; }
    .stat-item { transition: transform 0.2s ease-in-out; }
    .stat-item:hover { transform: translateY(-5px); }

    /* Category Header */
    .category-header { cursor: pointer; transition: all 0.3s ease; border-left: 4px solid transparent; }
    .category-header:hover { background-color: #f8f9fa !important; border-left-color: #0d6efd; }
    .category-header .arrow { transition: transform 0.3s ease; }
    .category-header[aria-expanded="true"] .arrow { transform: rotate(180deg); color: #0d6efd; }

    /* Slider aur Cards */
    .slider-container { position: relative; }
    /* === YAHAN BADLAV KIYA GAYA HAI === */
    .scrolling-wrapper { 
        display: flex; 
        overflow-x: auto; 
        gap: 1rem; /* Gap kam kiya gaya hai */
        padding: 1.25rem 0.25rem; 
        scrollbar-width: none; 
        scroll-behavior: smooth; 
    }
    .scrolling-wrapper::-webkit-scrollbar { display: none; }

    .scrolling-wrapper .card { 
        flex: 0 0 auto; 
        width: 260px; /* Card ki chaudai kam ki gayi hai */
        border: 1px solid #e9ecef; 
        box-shadow: 0 4px 15px rgba(0,0,0,0.05); 
        transition: all 0.3s ease; 
    }
    .scrolling-wrapper .card:hover { transform: translateY(-8px); box-shadow: 0 8px 25px rgba(0,0,0,0.1); }
    
    .scroll-btn { 
        position: absolute; 
        top: 50%; 
        transform: translateY(-50%); 
        z-index: 10; 
        background-color: white;
        border: 1px solid #e0e0e0;
        border-radius: 50%; 
        width: 45px; 
        height: 45px; 
        display: flex; 
        align-items: center; 
        justify-content: center; 
        cursor: pointer; 
        box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
        transition: all 0.2s ease; 
        color: #333;
    }
    .scroll-btn:hover { 
        transform: translateY(-50%) scale(1.05);
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    .scroll-btn.left { left: -22px; } .scroll-btn.right { right: -22px; }
    
    /* "My Series" Section */
    .my-series-section {
        background: linear-gradient(135deg, #e6f0ff 0%, #f5eefc 100%);
        border-radius: 20px;
        padding: 3rem;
        border: 1px solid #e0e0e0;
    }


    .carousel-item {
        height: 500px;
        background-color: #333;
        background-size: cover;
        background-position: center;
        position: relative;
    }
    .carousel-caption {
        background-color: rgba(0, 0, 0, 0.5);
        padding: 1.5rem 2rem;
        border-radius: 0.5rem;
        max-width: 700px;
        margin-bottom: 3rem;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.6);
    }

    /* Rest of the page styles */
    @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .fade-in-up { opacity: 0; }
    .fade-in-up.is-visible { animation: fadeInUp 0.8s ease-out forwards; }
    .stats-bar { background-color: #f8f9fa; padding: 2.5rem 0; }
    .stat-item:hover { transform: translateY(-5px); }
    .category-header { cursor: pointer; border-left: 4px solid transparent; transition: all 0.3s ease; }
    .category-header:hover { background-color: #f8f9fa !important; border-left-color: #0d6efd; }
    .category-header .arrow { transition: transform 0.3s ease; }
    .category-header[aria-expanded="true"] .arrow { transform: rotate(180deg); color: #0d6efd; }
    .slider-container { position: relative; }
    .scrolling-wrapper { display: flex; overflow-x: auto; gap: 1rem; padding: 1.25rem 0.25rem; scrollbar-width: none; scroll-behavior: smooth; }
    .scrolling-wrapper::-webkit-scrollbar { display: none; }
    .scrolling-wrapper .card { flex: 0 0 260px; border: 1px solid #e9ecef; box-shadow: 0 4px 15px rgba(0,0,0,0.05); transition: all 0.3s ease; }
    .scrolling-wrapper .card:hover { transform: translateY(-8px); box-shadow: 0 8px 25px rgba(0,0,0,0.1); }
    .scroll-btn { position: absolute; top: 50%; transform: translateY(-50%); z-index: 10; background-color: white; border: 1px solid #e0e0e0; border-radius: 50%; width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 2px 10px rgba(0,0,0,0.1); transition: all 0.2s ease; color: #333; }
    .scroll-btn:hover { transform: translateY(-50%) scale(1.05); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
    .scroll-btn.left { left: -22px; } .scroll-btn.right { right: -22px; }
    .my-series-section { background: linear-gradient(135deg, #e6f0ff 0%, #f5eefc 100%); border-radius: 20px; padding: 3rem; border: 1px solid #e0e0e0; }



    
    .marquee-container {
        margin-top: -10px;
        margin-bottom: 0.9rem; 
        background-color: #fff;
        border-top: 1px solid #e0e0e0;
        border-bottom: 1px solid #e0e0e0;
        overflow: hidden;
        display: flex;
        align-items: center;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        padding: 0.2rem 0;
    }
    .marquee-label {
        background-color: #dc3545; 
        color: white;
        font-weight: 600;
        white-space: nowrap;
        z-index: 2;
        padding: 0.15rem 0.6rem;  
        font-size: 0.75rem;
    }
    .marquee-content {
        display: inline-block;
        white-space: nowrap;
        padding-left: 100%;
        animation: marquee 20s linear infinite;
        font-size: 0.8rem
    }
    .marquee-content a {
        display: inline-block;
        margin: 0 1.5rem;
        color: #343a40;
        text-decoration: none;
        font-weight: 500;
    }
    .marquee-content a:hover {
        color: #fd0d0dff;
    }
    @keyframes marquee {
        0%   { transform: translateX(0); }
        100% { transform: translateX(-100%); }
    }
    /* === MARQUEE CSS YAHAN KHATAM HOTA HAI === */






</style>



{% if notices %}
<div class="marquee-container">
    <div class="marquee-label">
        Latest Notifications
    </div>
    <div class="marquee-content" id="marquee">
        {% for notice in notices %}
            <a href="{% url 'exams:notice_detail' notice.id %}">
                <i class="bi bi-bell-fill me-1"></i> {{ notice.title }}
            </a>
        {% endfor %}
        <!-- Content ko repeat karein taaki smooth scroll ho sake -->
        {% for notice in notices %}
            <a href="{% url 'exams:notice_detail' notice.id %}">
                <i class="bi bi-bell-fill me-1"></i> {{ notice.title }}
            </a>
        {% endfor %}
    </div>
</div>
{% endif %}
<!-- === NAYA SECTION YAHAN KHATAM HOTA HAI === -->








<!-- ========= HERO SECTION ========= -->
<div id="heroCarousel" class="carousel slide mb-5" data-bs-ride="carousel">
    <div class="carousel-indicators">
        <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
        <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
        <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="2" aria-label="Slide 3"></button>
        <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="3" aria-label="Slide 4"></button>
    </div>
    <div class="carousel-inner">
        <div class="carousel-item active" style="background-image: url('https://res.cloudinary.com/dacbjcquj/image/upload/v1762685306/carousel-1_x0roun.jpg');">
            <div class="carousel-caption d-none d-md-block">
                <h2 class="display-5 fw-bold">Master Your Exams</h2>
                <p class="lead">Practice with thousands of mock tests designed by experts to ensure your success.</p>
                <a href="#categoryList" class="btn btn-primary btn-lg mt-3">Explore Exams</a>
            </div>
        </div>
        <div class="carousel-item" style="background-image: url('https://res.cloudinary.com/dacbjcquj/image/upload/v1762685307/carousel-2_gb5ugo.jpg');">
            <div class="carousel-caption d-none d-md-block">
                <h2 class="display-5 fw-bold">In-Depth Performance Analytics</h2>
                <p class="lead">Track your progress, identify weak areas, and improve with detailed reports.</p>
                <a href="{% if user.is_authenticated %}{% url 'users:dashboard' %}{% else %}{% url 'users:login' %}{% endif %}" class="btn btn-primary btn-lg mt-3">View Dashboard</a>
            </div>
        </div>
        <div class="carousel-item" style="background-image: url('https://res.cloudinary.com/dacbjcquj/image/upload/v1762685308/carousel-3_mwjzsj.jpg');">
            <div class="carousel-caption d-none d-md-block">
                <h2 class="display-5 fw-bold">Expert-Curated Content</h2>
                <p class="lead">Access high-quality study materials and questions covering all major government exams.</p>
                <a href="{% url 'exams:about_us' %}" class="btn btn-primary btn-lg mt-3">Learn More</a>
            </div>
        </div>
        <div class="carousel-item" style="background-image: url('https://res.cloudinary.com/dacbjcquj/image/upload/v1762685308/carousel-4_shgaax.jpg');">
            <div class="carousel-caption d-none d-md-block">
                <h2 class="display-5 fw-bold">Start Your Journey Today</h2>
                <p class="lead">Join thousands of successful aspirants. Sign up now and take the first step towards your dream job.</p>
                <a href="{% url 'users:signup' %}" class="btn btn-primary btn-lg mt-3">Sign Up Free</a>
            </div>
        </div>
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev"><span class="carousel-control-prev-icon" aria-hidden="true"></span></button>
    <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next"><span class="carousel-control-next-icon" aria-hidden="true"></span></button>
</div>

<!-- ========= STATS BAR ========= -->
<div class="stats-bar">
    <div class="container">
        <div class="row text-center">
            <div class="col-md-4 stat-item fade-in-up">
               
                <h3 class="fw-bold">{{ category_count }}+</h3>
                <p class="text-muted">Exams</p>
            </div>
            <div class="col-md-4 stat-item fade-in-up">
               
                <h3 class="fw-bold">{{ mock_test_count }}+</h3>
                <p class="text-muted">Mock Tests</p>
            </div>
            <div class="col-md-4 stat-item fade-in-up">
                
                <h3 class="fw-bold">{{ aspirant_count }}+</h3>
                <p class="text-muted">Happy Aspirants</p>
            </div>
        </div>
    </div>
</div>

<div class="container my-5">
    <!-- ========= EXAM CATEGORIES SECTION ========= -->
    <div class="text-center mb-5 fade-in-up">
        <h2 class="fw-bold">All Exams </h2>
        <p class="text-muted">Select exams to reveal tests and add them to your practice arena.</p>
    </div>

    <div id="categoryList">
    {% for category in categories %}
        {% if category.exams.all %}
            <div class="category-container mb-3 fade-in-up">
                <div class="p-3 bg-white border rounded d-flex justify-content-between align-items-center category-header" data-bs-toggle="collapse" data-bs-target="#collapse-{{ category.id }}" aria-expanded="false">
                    <div class="d-flex align-items-center">
                        <img src="{% static category.logo_url %}" alt="{{ category.name }} Logo" class="me-3" style="width: 40px; height: 40px; object-fit: contain;">
                        <h5 class="mb-0 category-name">{{ category.name }} Exams</h5>
                    </div>
                    <span class="arrow fs-4">&#9660;</span>
                </div>
                <div class="collapse" id="collapse-{{ category.id }}">
                    <div class="slider-container pt-2">
                        <div class="scrolling-wrapper" id="slider-{{ category.id }}">
                            {% for exam in category.exams.all %}
                                <div class="card">
                                    <div class="card-body">
                                       
                                        
                                        <h5 class="card-title">{{ exam.title }}</h5>
                                        <p class="card-text text-muted small">{{ exam.description|truncatewords:15 }}</p>
                                    </div>
                                    <div class="card-footer bg-white border-0 pb-3">
                                        {% if user.is_authenticated %}
                                            {% if user in exam.subscribers.all %}
                                                <button class="btn btn-secondary w-100" disabled>Added</button>
                                            {% else %}
                                                <a href="{% url 'exams:add_exam' exam.id %}" class="btn btn-primary w-100">Add to My Tests</a>
                                            {% endif %}
                                        {% else %}
                                            <a href="{% url 'users:login' %}" class="btn btn-outline-primary w-100">Login to Add</a>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                        <div class="scroll-btn left" onclick="event.stopPropagation(); scrollSlider('slider-{{ category.id }}', -280)">&#10094;</div>
                        <div class="scroll-btn right" onclick="event.stopPropagation(); scrollSlider('slider-{{ category.id }}', 280)">&#10095;</div>
                    </div>
                </div>
            </div>
        {% endif %}
    {% endfor %}
    </div>

    <!-- ========= "MY TEST SERIES" / PRACTICE ARENA SECTION ========= -->
    {% if user.is_authenticated and user.subscribed_exams.all %}
    <div class="my-series-section mt-5 fade-in-up">
        <div class="text-center mb-4">
            <h2 class="fw-bold">Enrolled Test Series</h2>
            <p class="text-muted fs-5">Jump back in and continue your preparation!</p>
        </div>
        <div class="slider-container">
            <div class="scrolling-wrapper" id="subscribed-slider">
                {% for exam in user.subscribed_exams.all %}
                    <div class="card text-center">
                        <div class="card-body">
                            <img src="{% static exam.logo_url %}" class="img-fluid mb-3" alt="{{ exam.title }} Logo" style="max-height: 70px; object-fit: contain;">
                            <h5 class="card-title">{{ exam.title }}</h5>
                            <p class="card-text text-muted small">{{ exam.description|truncatewords:10 }}</p>
                        </div>
                        <div class="card-footer bg-white border-0 pb-3">
                            <a href="{% url 'test_series:mock_test_list' exam.id %}" class="btn btn-success w-100">View Mock Tests</a>
                        </div>
                    </div>
                {% endfor %}
            </div>
            <div class="scroll-btn left" onclick="scrollSlider('subscribed-slider', -280)">&#10094;</div>
            <div class="scroll-btn right" onclick="scrollSlider('subscribed-slider', 280)">&#10095;</div>
        </div>
    </div>
    {% endif %}
</div>

<!-- JavaScript for Search, Slider, and Scroll Animations -->
<script>

    //news stop and Resume
    const marquee = document.getElementById("marquee");

    // Mouse Hover Pause/Resume
    marquee.addEventListener("mouseover", () => {
        marquee.style.animationPlayState = "paused";
    });

    marquee.addEventListener("mouseout", () => {
        marquee.style.animationPlayState = "running";
    });

    // Mobile Touch Pause/Resume
    marquee.addEventListener("touchstart", () => {
        marquee.style.animationPlayState = "paused";
    });

    marquee.addEventListener("touchend", () => {
        marquee.style.animationPlayState = "running";
    });


    // Slider Function
    function scrollSlider(sliderId, distance) {
        const slider = document.getElementById(sliderId);
        if (slider) {
            slider.scrollLeft += distance;
        }
    }

    // Search Filter Function
    function filterCategories() {
        const input = document.getElementById('examSearch');
        const filter = input.value.toUpperCase();
        const categoryList = document.getElementById('categoryList');
        const categories = categoryList.getElementsByClassName('category-container');
        for (let i = 0; i < categories.length; i++) {
            const categoryName = categories[i].getElementsByClassName('category-name')[0];
            if (categoryName) {
                const txtValue = categoryName.textContent || categoryName.innerText;
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    categories[i].style.display = "";
                } else {
                    categories[i].style.display = "none";
                }
            }
        }
    }

    // Scroll Animations Function
    document.addEventListener("DOMContentLoaded", function() {
        const animatedElements = document.querySelectorAll('.fade-in-up');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('is-visible');
                    observer.unobserve(entry.target);
                }
            });
        }, {
            threshold: 0.1
        });
        animatedElements.forEach(el => {
            observer.observe(el);
        });
    });
</script>
{% endblock %}